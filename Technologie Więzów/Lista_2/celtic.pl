:- use_module(library(clpfd)).

% Tiles = [[0, 0, 0, 1],[1, 0, 0, 0],[0, 1, 0, 0],[0, 0, 1, 0],[0, 1, 0, 1],[1, 0, 1, 0],[1, 0, 0, 1],[1, 1, 0, 0],[0, 1, 1, 0],[0, 0, 1, 1],[1, 0, 1, 1],[1, 1, 0, 1],[1, 1, 1, 0],[0, 1, 1, 1],[1, 1, 1, 1]],


add_constraints(Tiles, X, Y, Z) :-
  nth1(1, X, X1), nth1(2, X, X2), nth1(3, X, X3), nth1(4, X, X4), nth1(5, X, X5), nth1(6, X, X6),
  nth1(7, X, X7), nth1(8, X, X8), nth1(9, X, X9), nth1(10, X, X10), nth1(11, X, X11), nth1(12, X, X12),
  nth1(13, X, X13), nth1(14, X, X14), nth1(15, X, X15), nth1(16, X, X16), nth1(17, X, X17), nth1(18, X, X18),
  nth1(19, X, X19), nth1(20, X, X20), nth1(21, X, X21), nth1(22, X, X22), nth1(23, X, X23), nth1(24, X, X24),
  nth1(25, X, X25), nth1(26, X, X26), nth1(27, X, X27), nth1(28, X, X28), nth1(29, X, X29), nth1(30, X, X30),
  nth1(1, Y, Y1), nth1(2, Y, Y2), nth1(3, Y, Y3), nth1(4, Y, Y4), nth1(5, Y, Y5), nth1(6, Y, Y6),
  nth1(7, Y, Y7), nth1(8, Y, Y8), nth1(9, Y, Y9), nth1(10, Y, Y10), nth1(11, Y, Y11), nth1(12, Y, Y12),
  nth1(13, Y, Y13), nth1(14, Y, Y14), nth1(15, Y, Y15), nth1(16, Y, Y16), nth1(17, Y, Y17), nth1(18, Y, Y18),
  nth1(19, Y, Y19), nth1(20, Y, Y20), nth1(21, Y, Y21), nth1(22, Y, Y22), nth1(23, Y, Y23), nth1(24, Y, Y24),
  nth1(25, Y, Y25), nth1(26, Y, Y26), nth1(27, Y, Y27), nth1(28, Y, Y28), nth1(29, Y, Y29), nth1(30, Y, Y30),
  nth1(1, Z, Z1), nth1(2, Z, Z2), nth1(3, Z, Z3), nth1(4, Z, Z4), nth1(5, Z, Z5),
  nth1(6, Z, Z6),  nth1(7, Z, Z7), nth1(8, Z, Z8), nth1(9, Z, Z9), nth1(10, Z, Z10),
  nth1(11, Z, Z11), nth1(12, Z, Z12),  nth1(13, Z, Z13), nth1(14, Z, Z14), nth1(15, Z, Z15),
  nth1(16, Z, Z16), nth1(17, Z, Z17), nth1(18, Z, Z18),  nth1(19, Z, Z19), nth1(20, Z, Z20),
  nth1(21, Z, Z21), nth1(22, Z, Z22), nth1(23, Z, Z23), nth1(24, Z, Z24),  nth1(25, Z, Z25),
  Y1 #= 0, Y6 #= 0, Y7 #= 0, Y12 #= 0, Y13 #= 0, Y18 #= 0, Y19 #= 0, Y24 #= 0, Y25 #= 0, Y30 #= 0,
  X1 #= 0, X6 #= 0, X7 #= 0, X12 #= 0, X13 #= 0, X18 #= 0, X19 #= 0, X24 #= 0, X25 #= 0, X30 #= 0,
  nth1(Z1, Tiles, T1), nth1(1, T1, T1_1), T1_1 #= X1, nth1(2, T1, T1_2), T1_2 #= Y1, nth1(3, T1, T1_3), T1_3 #= X2, nth1(4, T1, T1_4), T1_4 #= Y2,
  nth1(Z2, Tiles, T2), nth1(1, T2, T2_1), T2_1 #= X2, nth1(2, T2, T2_2), T2_2 #= Y7, nth1(3, T2, T2_3), T2_3 #= X3, nth1(4, T2, T2_4), T2_4 #= Y8,
  nth1(Z3, Tiles, T3), nth1(1, T3, T3_1), T3_1 #= X3, nth1(2, T3, T3_2), T3_2 #= Y13, nth1(3, T3, T3_3), T3_3 #= X4, nth1(4, T3, T3_4), T3_4 #= Y14,
  nth1(Z4, Tiles, T4), nth1(1, T4, T4_1), T4_1 #= X4, nth1(2, T4, T4_2), T4_2 #= Y19, nth1(3, T4, T4_3), T4_3 #= X5, nth1(4, T4, T4_4), T4_4 #= Y20,
  nth1(Z5, Tiles, T5), nth1(1, T5, T5_1), T5_1 #= X5, nth1(2, T5, T5_2), T5_2 #= Y25, nth1(3, T5, T5_3), T5_3 #= X6, nth1(4, T5, T5_4), T5_4 #= Y26,
  nth1(Z6, Tiles, T6), nth1(1, T6, T6_1), T6_1 #= X7, nth1(2, T6, T6_2), T6_2 #= Y2, nth1(3, T6, T6_3), T6_3 #= X8, nth1(4, T6, T6_4), T6_4 #= Y3,
  nth1(Z7, Tiles, T7), nth1(1, T7, T7_1), T7_1 #= X8, nth1(2, T7, T7_2), T7_2 #= Y8, nth1(3, T7, T7_3), T7_3 #= X9, nth1(4, T7, T7_4), T7_4 #= Y9,
  nth1(Z8, Tiles, T8), nth1(1, T8, T8_1), T8_1 #= X9, nth1(2, T8, T8_2), T8_2 #= Y14, nth1(3, T8, T8_3), T8_3 #= X10, nth1(4, T8, T8_4), T8_4 #= Y15,
  nth1(Z9, Tiles, T9), nth1(1, T9, T9_1), T9_1 #= X10, nth1(2, T9, T9_2), T9_2 #= Y20, nth1(3, T9, T9_3), T9_3 #= X11, nth1(4, T9, T9_4), T9_4 #= Y21,
  nth1(Z10, Tiles, T10), nth1(1, T10, T10_1), T10_1 #= X11, nth1(2, T10, T10_2), T10_2 #= Y26, nth1(3, T10, T10_3), T10_3 #= X12, nth1(4, T10, T10_4), T10_4 #= Y27,
  nth1(Z11, Tiles, T11), nth1(1, T11, T11_1), T11_1 #= X13, nth1(2, T11, T11_2), T11_2 #= Y3, nth1(3, T11, T11_3), T11_3 #= X14, nth1(4, T11, T11_4), T11_4 #= Y4,
  nth1(Z12, Tiles, T12), nth1(1, T12, T12_1), T12_1 #= X14, nth1(2, T12, T12_2), T12_2 #= Y9, nth1(3, T12, T12_3), T12_3 #= X15, nth1(4, T12, T12_4), T12_4 #= Y10,
  nth1(Z13, Tiles, T13), nth1(1, T13, T13_1), T13_1 #= X15, nth1(2, T13, T13_2), T13_2 #= Y15, nth1(3, T13, T13_3), T13_3 #= X16, nth1(4, T13, T13_4), T13_4 #= Y16,
  nth1(Z14, Tiles, T14), nth1(1, T14, T14_1), T14_1 #= X16, nth1(2, T14, T14_2), T14_2 #= Y21, nth1(3, T14, T14_3), T14_3 #= X17, nth1(4, T14, T14_4), T14_4 #= Y22,
  nth1(Z15, Tiles, T15), nth1(1, T15, T15_1), T15_1 #= X17, nth1(2, T15, T15_2), T15_2 #= Y27, nth1(3, T15, T15_3), T15_3 #= X18, nth1(4, T15, T15_4), T15_4 #= Y28,
  nth1(Z16, Tiles, T16), nth1(1, T16, T16_1), T16_1 #= X19, nth1(2, T16, T16_2), T16_2 #= Y4, nth1(3, T16, T16_3), T16_3 #= X20, nth1(4, T16, T16_4), T16_4 #= Y5,
  nth1(Z17, Tiles, T17), nth1(1, T17, T17_1), T17_1 #= X20, nth1(2, T17, T17_2), T17_2 #= Y10, nth1(3, T17, T17_3), T17_3 #= X21, nth1(4, T17, T17_4), T17_4 #= Y11,
  nth1(Z18, Tiles, T18), nth1(1, T18, T18_1), T18_1 #= X21, nth1(2, T18, T18_2), T18_2 #= Y16, nth1(3, T18, T18_3), T18_3 #= X22, nth1(4, T18, T18_4), T18_4 #= Y17,
  nth1(Z19, Tiles, T19), nth1(1, T19, T19_1), T19_1 #= X22, nth1(2, T19, T19_2), T19_2 #= Y22, nth1(3, T19, T19_3), T19_3 #= X23, nth1(4, T19, T19_4), T19_4 #= Y23,
  nth1(Z20, Tiles, T20), nth1(1, T20, T20_1), T20_1 #= X23, nth1(2, T20, T20_2), T20_2 #= Y28, nth1(3, T20, T20_3), T20_3 #= X24, nth1(4, T20, T20_4), T20_4 #= Y29,
  nth1(Z21, Tiles, T21), nth1(1, T21, T21_1), T21_1 #= X25, nth1(2, T21, T21_2), T21_2 #= Y5, nth1(3, T21, T21_3), T21_3 #= X26, nth1(4, T21, T21_4), T21_4 #= Y6,
  nth1(Z22, Tiles, T22), nth1(1, T22, T22_1), T22_1 #= X26, nth1(2, T22, T22_2), T22_2 #= Y11, nth1(3, T22, T22_3), T22_3 #= X27, nth1(4, T22, T22_4), T22_4 #= Y12,
  nth1(Z23, Tiles, T23), nth1(1, T23, T23_1), T23_1 #= X27, nth1(2, T23, T23_2), T23_2 #= Y17, nth1(3, T23, T23_3), T23_3 #= X28, nth1(4, T23, T23_4), T23_4 #= Y18,
  nth1(Z24, Tiles, T24), nth1(1, T24, T24_1), T24_1 #= X28, nth1(2, T24, T24_2), T24_2 #= Y23, nth1(3, T24, T24_3), T24_3 #= X29, nth1(4, T24, T24_4), T24_4 #= Y24,
  nth1(Z25, Tiles, T25), nth1(1, T25, T25_1), T25_1 #= X29, nth1(2, T25, T25_2), T25_2 #= Y29, nth1(3, T25, T25_3), T25_3 #= X30, nth1(4, T25, T25_4), T25_4 #= Y30.

celtic(Z, Tiles) :-
  length(X, 30),
  X ins 0..1,
  length(Y, 30),
  Y ins 0..1,
  length(Z, 25),
  Z ins 1..15,
  add_constraints(Tiles, X, Y, Z).
