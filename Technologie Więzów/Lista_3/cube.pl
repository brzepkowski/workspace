:- use_module(library(clpfd)).

matrix_rotate(X, Z) :-
  transpose(X, Y),
  maplist(reverse, Y, Z).

list_sum([Item], Item).
list_sum([Item1,Item2 | Tail], Total) :-
    list_sum([Item1+Item2|Tail], Total).

flatten_([], []).
flatten_([H|T], L) :-
  flatten_(T, Ls),
  append(H, Ls, L).

mult_by_scalar1([], _, []).
mult_by_scalar1([M|Ms], S, [M*S|Ts]) :-
  mult_by_scalar1(Ms, S, Ts).

mult_by_scalar2([], _, []).
mult_by_scalar2([M|Ms], S, [T|Ts]) :-
  mult_by_scalar1(M, S, T),
  mult_by_scalar2(Ms, S, Ts).

mult_by_scalar3([], _, []).
mult_by_scalar3([M|Ms], S, [T|Ts]) :-
  mult_by_scalar2(M, S, T),
  mult_by_scalar3(Ms, S, Ts).


add_matrices1([], [], []).
add_matrices1([M|Ms], [N|Ns], [M+N|Ts]) :-
  add_matrices1(Ms, Ns, Ts).

add_matrices2([], [], []).
add_matrices2([M|Ms], [N|Ns], [T|Ts]) :-
  add_matrices1(M, N, T),
  add_matrices2(Ms, Ns, Ts).

add_matrices3([], [], []).
add_matrices3([M|Ms], [N|Ns], [T|Ts]) :-
  add_matrices2(M, N, T),
  add_matrices3(Ms, Ns, Ts).

multiply_many_by_scalar([], [], []).
multiply_many_by_scalar([R|Rs], [V|Vs], [L|Ls]) :-
  mult_by_scalar3(R, V, L),
  multiply_many_by_scalar(Rs, Vs, Ls).

add_many_matrices([Item], Item).
add_many_matrices([Item1,Item2 | Tail], Total) :-
    add_matrices3(Item1, Item2, Result),
    add_many_matrices([Result|Tail], Total).

% X - macierz, którą będziemy obracać, I - licznik, ile obrotów wykonaliśmy, L - lista ze wszsystkim rotacjami pierwotnej macierzy
generate_rotations(_, 4, []).
generate_rotations(X, I, [X|L]) :-
  matrix_rotate(X, Y),
  I1 is I + 1,
  generate_rotations(Y, I1, L).

constraints1(L) :-
  %--------------------PIONOWO--------------------
  % Lewa strona
  generate_rotations([[[0,0,0],[0,0,0],[1,0,0]],[[0,0,0],[0,0,0],[1,0,0]],[[0,0,0],[1,0,0],[1,0,0]]], 0, L0),
  generate_rotations([[[0,0,0],[0,0,0],[1,0,0]],[[0,0,0],[0,0,0],[1,0,0]],[[0,0,0],[0,0,0],[1,1,0]]], 0, L1),
  generate_rotations([[[0,0,0],[1,0,0],[0,0,0]],[[0,0,0],[1,0,0],[0,0,0]],[[0,0,0],[1,0,0],[1,0,0]]], 0, L2),
  generate_rotations([[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[1,1,0]]], 0, L3),
  generate_rotations([[[0,0,0],[1,0,0],[1,0,0]],[[0,0,0],[0,0,0],[1,0,0]],[[0,0,0],[0,0,0],[1,0,0]]], 0, L4),
  generate_rotations([[[0,0,0],[0,0,0],[1,1,0]],[[0,0,0],[0,0,0],[1,0,0]],[[0,0,0],[0,0,0],[1,0,0]]], 0, L5),
  generate_rotations([[[0,0,0],[1,0,0],[1,0,0]],[[0,0,0],[1,0,0],[0,0,0]],[[0,0,0],[1,0,0],[0,0,0]]], 0, L6),
  generate_rotations([[[0,0,0],[0,0,0],[1,1,0]],[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[0,1,0]]], 0, L7),
  % Środek
  generate_rotations([[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,1,0],[0,1,0]]], 0, L8),
  generate_rotations([[[0,0,0],[0,1,0],[0,0,0]],[[0,0,0],[0,1,0],[0,0,0]],[[0,0,0],[0,1,0],[0,1,0]]], 0, L9),
  generate_rotations([[[0,0,0],[0,1,0],[0,1,0]],[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[0,1,0]]], 0, L10),
  generate_rotations([[[0,0,0],[0,1,0],[0,1,0]],[[0,0,0],[0,1,0],[0,0,0]],[[0,0,0],[0,1,0],[0,0,0]]], 0, L11),
  % Prawa strona
  generate_rotations([[[0,0,0],[0,0,0],[0,0,1]],[[0,0,0],[0,0,0],[0,0,1]],[[0,0,0],[0,0,1],[0,0,1]]], 0, L12),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,1]],[[0,0,0],[0,0,0],[0,0,1]],[[0,0,0],[0,0,0],[0,1,1]]], 0, L13),
  generate_rotations([[[0,0,0],[0,0,1],[0,0,0]],[[0,0,0],[0,0,1],[0,0,0]],[[0,0,0],[0,0,1],[0,0,1]]], 0, L14),
  generate_rotations([[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[0,1,1]]], 0, L15),
  generate_rotations([[[0,0,0],[0,0,1],[0,0,1]],[[0,0,0],[0,0,0],[0,0,1]],[[0,0,0],[0,0,0],[0,0,1]]], 0, L16),
  generate_rotations([[[0,0,0],[0,0,0],[0,1,1]],[[0,0,0],[0,0,0],[0,0,1]],[[0,0,0],[0,0,0],[0,0,1]]], 0, L17),
  generate_rotations([[[0,0,0],[0,0,1],[0,0,1]],[[0,0,0],[0,0,1],[0,0,0]],[[0,0,0],[0,0,1],[0,0,0]]], 0, L18),
  generate_rotations([[[0,0,0],[0,0,0],[0,1,1]],[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[0,1,0]]], 0, L19),
  %--------------------POZIOMO---------------------
  % Lewa strona
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[1,0,0]],[[0,0,0],[0,0,0],[1,1,1]]], 0, L20),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,0,0],[1,1,1]]], 0, L21),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,1,1],[1,0,0]]], 0, L22),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[1,1,1]],[[0,0,0],[0,0,0],[1,0,0]]], 0, L23),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,0,0],[1,1,1]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L24),
  generate_rotations([[[0,0,0],[0,0,0],[1,0,0]],[[0,0,0],[0,0,0],[1,1,1]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L25),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,1,1],[1,0,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L26),
  generate_rotations([[[0,0,0],[0,0,0],[1,1,1]],[[0,0,0],[0,0,0],[1,0,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L27),
  generate_rotations([[[0,0,0],[1,0,0],[1,1,1]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L28),
  generate_rotations([[[0,0,0],[1,1,1],[1,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L29),
  % Prawa strona
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,1]],[[0,0,0],[0,0,0],[1,1,1]]], 0, L30),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,1],[1,1,1]]], 0, L31),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,1,1],[0,0,1]]], 0, L32),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[1,1,1]],[[0,0,0],[0,0,0],[0,0,1]]], 0, L33),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,1],[1,1,1]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L34),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,1]],[[0,0,0],[0,0,0],[1,1,1]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L35),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,1,1],[0,0,1]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L36),
  generate_rotations([[[0,0,0],[0,0,0],[1,1,1]],[[0,0,0],[0,0,0],[0,0,1]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L37),
  generate_rotations([[[0,0,0],[0,0,1],[1,1,1]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L38),
  generate_rotations([[[0,0,0],[1,1,1],[0,0,1]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L39),
  %--------------------ŚRODEK---------------------
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[1,0,0],[1,0,0],[1,1,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L40),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,1,0],[0,1,0],[1,1,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L41),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,1,0],[0,1,0],[0,1,1]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L42),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,1],[0,0,1],[0,1,1]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L43),
  flatten_([L0, L1, L2, L3, L4, L5, L6, L7, L8, L9, L10, L11, L12, L13, L14, L15, L16, L17, L18, L19, L20, L21,
    L22, L23, L24, L25, L26, L27, L28, L29, L30, L31, L32, L33, L34, L35, L36, L37, L38, L39, L40, L41, L42, L43], L).

constraints2(L) :-
  %--------------------PIONOWO--------------------
  % Lewa strona
  generate_rotations([[[0,0,0],[0,0,0],[1,0,0]],[[0,0,0],[1,0,0],[1,0,0]],[[0,0,0],[0,0,0],[1,0,0]]], 0, L0),
  generate_rotations([[[0,0,0],[0,0,0],[1,0,0]],[[0,0,0],[0,0,0],[1,1,0]],[[0,0,0],[0,0,0],[1,0,0]]], 0, L1),
  generate_rotations([[[0,0,0],[1,0,0],[0,0,0]],[[0,0,0],[1,0,0],[1,0,0]],[[0,0,0],[1,0,0],[0,0,0]]], 0, L2),
  generate_rotations([[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[1,1,0]],[[0,0,0],[0,0,0],[0,1,0]]], 0, L3),
  % Środek
  generate_rotations([[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,1,0],[0,1,0]],[[0,0,0],[0,0,0],[0,1,0]]], 0, L4),
  generate_rotations([[[0,0,0],[0,1,0],[0,0,0]],[[0,0,0],[0,1,0],[0,1,0]],[[0,0,0],[0,1,0],[0,0,0]]], 0, L5),
  % Prawa strona
  generate_rotations([[[0,0,0],[0,0,0],[0,0,1]],[[0,0,0],[0,0,1],[0,0,1]],[[0,0,0],[0,0,0],[0,0,1]]], 0, L6),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,1]],[[0,0,0],[0,0,0],[0,1,1]],[[0,0,0],[0,0,0],[0,0,1]]], 0, L7),
  generate_rotations([[[0,0,0],[0,0,1],[0,0,0]],[[0,0,0],[0,0,1],[0,0,1]],[[0,0,0],[0,0,1],[0,0,0]]], 0, L8),
  generate_rotations([[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[0,1,1]],[[0,0,0],[0,0,0],[0,1,0]]], 0, L9),
  %--------------------POZIOMO---------------------
  generate_rotations([[[0,0,0],[0,0,0],[1,1,1]],[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L10),
  generate_rotations([[[0,0,0],[0,1,0],[1,1,1]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L11),
  generate_rotations([[[0,0,0],[1,1,1],[0,1,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L12),
  generate_rotations([[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[1,1,1]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L13),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,1,0],[1,1,1]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L14),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[1,1,1]],[[0,0,0],[0,0,0],[0,1,0]]], 0, L15),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,1,1],[0,1,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L16),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[1,1,1]]], 0, L17),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,1,0],[1,1,1]]], 0, L18),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,1,1],[0,1,0]]], 0, L19),
  %--------------------ŚRODEK---------------------
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,1,0],[1,1,0],[0,1,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L20),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,1,0],[0,1,1],[0,1,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L21),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[1,0,0],[1,1,0],[1,0,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L22),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,1],[0,1,1],[0,0,1]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L23),
  flatten_([L0, L1, L2, L3, L4, L5, L6, L7, L8, L9, L10, L11, L12, L13, L14, L15, L16, L17, L18, L19, L20, L21, L22, L23], L).

constraints3(L) :-
  %--------------------PIONOWO--------------------
  % Lewa strona
  generate_rotations([[[0,0,0],[0,0,0],[1,0,0]],[[0,0,0],[1,0,0],[1,0,0]],[[0,0,0],[1,0,0],[0,0,0]]], 0, L0),
  generate_rotations([[[0,0,0],[1,0,0],[0,0,0]],[[0,0,0],[1,0,0],[1,0,0]],[[0,0,0],[0,0,0],[1,0,0]]], 0, L1),
  generate_rotations([[[0,0,0],[0,0,0],[1,0,0]],[[0,0,0],[0,0,0],[1,1,0]],[[0,0,0],[0,0,0],[0,1,0]]], 0, L2),
  generate_rotations([[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[1,1,0]],[[0,0,0],[0,0,0],[1,0,0]]], 0, L3),
  % Środek
  generate_rotations([[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,1,0],[0,1,0]],[[0,0,0],[0,1,0],[0,0,0]]], 0, L4),
  generate_rotations([[[0,0,0],[0,1,0],[0,0,0]],[[0,0,0],[0,1,0],[0,1,0]],[[0,0,0],[0,0,0],[0,1,0]]], 0, L5),
  % Prawa strona
  generate_rotations([[[0,0,0],[0,0,0],[0,0,1]],[[0,0,0],[0,0,1],[0,0,1]],[[0,0,0],[0,0,1],[0,0,0]]], 0, L6),
  generate_rotations([[[0,0,0],[0,0,1],[0,0,0]],[[0,0,0],[0,0,1],[0,0,1]],[[0,0,0],[0,0,0],[0,0,1]]], 0, L7),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,1]],[[0,0,0],[0,0,0],[0,1,1]],[[0,0,0],[0,0,0],[0,1,0]]], 0, L8),
  generate_rotations([[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[0,1,1]],[[0,0,0],[0,0,0],[0,0,1]]], 0, L9),
  %--------------------POZIOMO---------------------
  generate_rotations([[[0,0,0],[0,1,1],[1,1,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L10),
  generate_rotations([[[0,0,0],[1,1,0],[0,1,1]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L11),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,1,1],[1,1,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L12),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,1,0],[0,1,1]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L13),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,1,1],[1,1,0]]], 0, L14),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,1,0],[0,1,1]]], 0, L15),
  flatten_([L0, L1, L2, L3, L4, L5, L6, L7, L8, L9, L10, L11, L12, L13, L14, L15], L).

constraints4(L) :-
  %--------------------PIONOWO--------------------
  % Front
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[1,0,0]],[[0,0,0],[0,0,0],[1,1,0]]], 0, L0),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[1,1,0]]], 0, L1),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[1,1,0]],[[0,0,0],[0,0,0],[0,1,0]]], 0, L2),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[1,1,0]],[[0,0,0],[0,0,0],[1,0,0]]], 0, L3),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,1,1]],[[0,0,0],[0,0,0],[0,1,0]]], 0, L4),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,0,0],[0,1,1]]], 0, L5),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,1]],[[0,0,0],[0,0,0],[0,1,1]]], 0, L6),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,1,1]],[[0,0,0],[0,0,0],[0,0,1]]], 0, L7),
  % W głąb 1
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,0,0],[1,0,0]],[[0,0,0],[0,0,0],[1,0,0]]], 0, L8),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,0,0],[1,0,0]],[[0,0,0],[1,0,0],[0,0,0]]], 0, L9),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,0,0],[0,0,0]],[[0,0,0],[1,0,0],[1,0,0]]], 0, L10),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[1,0,0]],[[0,0,0],[1,0,0],[1,0,0]]], 0, L11),
  % W głąb 2
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,1,0],[0,1,0]],[[0,0,0],[0,0,0],[0,1,0]]], 0, L12),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,1,0],[0,1,0]],[[0,0,0],[0,1,0],[0,0,0]]], 0, L13),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,1,0],[0,0,0]],[[0,0,0],[0,1,0],[0,1,0]]], 0, L14),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,1,0]],[[0,0,0],[0,1,0],[0,1,0]]], 0, L15),
  % W głąb 3
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,1],[0,0,1]],[[0,0,0],[0,0,0],[0,0,1]]], 0, L16),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,1],[0,0,1]],[[0,0,0],[0,0,1],[0,0,0]]], 0, L17),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,1],[0,0,0]],[[0,0,0],[0,0,1],[0,0,1]]], 0, L18),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,1]],[[0,0,0],[0,0,1],[0,0,1]]], 0, L19),
  %--------------------POZIOMO---------------------
  % Rząd 1
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,0,0],[1,1,0]]], 0, L20),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,1,0],[1,0,0]]], 0, L21),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,1,0],[0,1,0]]], 0, L22),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,1,0],[1,1,0]]], 0, L23),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,1,0],[0,1,1]]], 0, L24),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,1,1],[0,1,0]]], 0, L25),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,1,1],[0,0,1]]], 0, L26),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,1],[0,1,1]]], 0, L27),
  % Rząd 2
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,0,0],[1,1,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L28),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,1,0],[1,0,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L29),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1,1,0],[0,1,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L30),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,1,0],[1,1,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L31),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,1,0],[0,1,1]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L32),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,1,1],[0,1,0]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L33),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,1,1],[0,0,1]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L34),
  generate_rotations([[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,1],[0,1,1]],[[0,0,0],[0,0,0],[0,0,0]]], 0, L35),
  flatten_([L0, L1, L2, L3, L4, L5, L6, L7, L8, L9, L10, L11, L12, L13, L14, L15, L16, L17, L18, L19, L20, L21,
    L22, L23, L24, L25, L26, L27, L28, L29, L30, L31, L32, L33, L34, L35], L).

final_constraints1([]).
final_constraints1([X|Xs]) :-
  X #= 1,
  final_constraints1(Xs).

final_constraints2([]).
final_constraints2([X|Xs]) :-
  final_constraints1(X),
  final_constraints2(Xs).

final_constraints3([]).
final_constraints3([X|Xs]) :-
  final_constraints2(X),
  final_constraints3(Xs).

print_([], []).
print_([R|Rs], [V|Vs]) :-
  (V =:= 1 -> writeln(R); true),
  print_(Rs, Vs).

cube(AllVars) :-
  length(Vars1, 176),
  length(Vars2, 176),
  length(Vars3, 176),
  length(Vars4, 176),
  length(Vars5, 96),
  length(Vars6, 64),
  length(Vars7, 144),
  Vars1 ins 0..1,
  Vars2 ins 0..1,
  Vars3 ins 0..1,
  Vars4 ins 0..1,
  Vars5 ins 0..1,
  Vars6 ins 0..1,
  Vars7 ins 0..1,
  % Każdy klocek użyty tylko raz
  list_sum(Vars1, Vars1_sum), Vars1_sum #= 1,
  list_sum(Vars2, Vars2_sum), Vars2_sum #= 1,
  list_sum(Vars3, Vars3_sum), Vars3_sum #= 1,
  list_sum(Vars4, Vars4_sum), Vars4_sum #= 1,
  list_sum(Vars5, Vars5_sum), Vars5_sum #= 1,
  list_sum(Vars6, Vars6_sum), Vars6_sum #= 1,
  list_sum(Vars7, Vars7_sum), Vars7_sum #= 1,
  constraints1(L1), %length(L1, Len1), write("L1: "), writeln(Len1),
  constraints2(L2), %length(L2, Len2), write("L2: "), writeln(Len2),
  constraints3(L3), %length(L3, Len3), write("L3: "), writeln(Len3),
  constraints4(L4), %length(L4, Len4), write("L4: "), writeln(Len4),
  flatten_([L1, L1, L1, L1, L2, L3, L4], AllRotations), % moja funkcja flatten_
  flatten([Vars1, Vars2, Vars3, Vars4, Vars5, Vars6, Vars7], AllVars), % wbudowana funkcja flatten
  multiply_many_by_scalar(AllRotations, AllVars, RotationsTimesVars),
  add_many_matrices(RotationsTimesVars, Final),
  final_constraints3(Final),
  label(AllVars),
  print_(AllRotations, AllVars).
